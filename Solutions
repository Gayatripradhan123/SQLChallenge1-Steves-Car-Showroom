1)  What are the details of all cars purchased in the year 2022?
select make, type, style, cost_$,purchase_date
from sales
left join cars
on sales.car_id = cars.car_id
where purchase_date like '2022%';


2) What is the total number of cars sold by each salesperson?
select sp.name, count(car_id) as no_of_cars_sold
from sales as s
left join salespersons as sp
on s.salesman_id = sp.salesman_id
group by sp.name;


3) What is the total revenue generated by each salesperson?
select sp.name, sum(cost_$) as revenue
from sales as s
inner join cars as c
on s.car_id = c.car_id
Inner join salespersons as sp
on s.salesman_id = sp.salesman_id
Group by sp.salesman_id
order by sum(cost_$) asc;


4) What are the details of the cars sold by each salesperson?
select name,purchase_date, make, type, style, cost_$
from cars as c
inner join sales as s
on c.car_id = s.car_id
inner join salespersons as sp
on s.salesman_id = sp.salesman_id
order by name asc;


5) What is the total revenue generated by each car type?
select (cost_$ * count(sale_id)) as revenue, c.type
from cars as c
inner join sales as s
on c.car_id = s.car_id
group by c.typemakemake
order by (cost_$* sale_id) asc;


6) What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
SELECT sp.name, s.sale_id, s.purchase_date, c.car_id, c.make, c.type, c.style, c.cost_$
from cars as c
inner join sales as s
on c.car_id = s.car_id
INNER join salespersons as sp
on s.salesman_id = sp.salesman_id
where sp.name = "Emily Wong" and purchase_date like "2021%";


7) What is the total revenue generated by the sales of hatchback cars?
SELECT c.style, sum(cost_$) as revenue
from cars as c
INNER JOIN sales as s
on c.car_id = s.car_id
WHERE c.style = 'Hatchback';


8) What is the total revenue generated by the sales of SUV cars in the year 2022?
SELECT c.style, sum(c.cost_$) as total_revenue
FROM sales as s
LEFT JOIN cars as c
on s.car_id = c.car_id
WHERE c.style = 'SUV' and s.purchase_date like '2022%';


9) What is the name & city of the salesperson who sold the most number of cars in the year 2023?
SELECT sp.name, sp.city,COUNT(s.sale_id) as no_of_cars_sold
FROM sales as s
LEFT JOIN salespersons as sp
on s.salesman_id = sp.salesman_id
where purchase_date like '2023%'
GROUP by sp.city
ORDER by COUNT(s.sale_id) desc
LIMIT 1;


10) What is the name & age of the salesperson who generated the highest revenue in the year 2022?
SELECT sp.name, sp.age, sum(cost_$) as revenue
FROM cars as c
LEFT JOIN sales as s
on c.car_id = s.car_id
LEFT JOIN salespersons as sp
on sp.salesman_id = s.salesman_id
WHERE purchase_date like '2022%'
GROUP by sp.name, sp.age
ORDER by sum(cost_$) DESC
LIMIT 1;
